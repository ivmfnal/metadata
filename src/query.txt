x1 = v1 and x2 = v2 and x3 = v3

select files.id, files.namespace, files.name, 
            a.name,
            a.int_array, a.float_array, a.string_array, a.bool_array,
            a.int_value, a.float_value, a.string_value, a.bool_value
    from files left outer join file_attributes a on (a.file_id = files.id)
    where files.id in (
            select distinct f.id as fid
                    from files, 
                        inner join files_datasets fd on fd.file_id = files.id,
                        inner join file_attributes a1 on a1.file_id = files.id,
                        inner join file_attributes a2 on a2.file_id = files.id,
                        inner join file_attributes a3 on a3.file_id = files.id
                    where fd.dataset_namespace=%s and fd.dataset_name=%s
                        and 
                        ( a1.name = 'x1' and a1.value = 'v1'
                        and a2.name = 'x2' and a2.value = 'v2'
                        and a3.name = 'x3' and a3.value = 'v3' )
        )
        
x1 = v1 or x2 = v2 or x3 = v3

    where files.id in (
            select distinct f.id as fid
                    from files, 
                        inner join files_datasets fd on fd.file_id = files.id,
                        inner join file_attributes a on a.file_id = files.id,
                    where fd.dataset_namespace=%s and fd.dataset_name=%s
                        and (
                            a.name = 'x1' and a.value = 'v1'
                        or a.name = 'x2' and a.value = 'v2'
                        or a.name = 'x3' and a.value = 'v3' )
    )


